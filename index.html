<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>BTC Expected Move</title>
  <style>
    body {
      margin: 0;
      background: #111;
      color: #eee;
      font-family: Arial, sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      height: 100vh;
    }
    header {
      padding: 20px;
      text-align: center;
      background: #1a1a1a;
      width: 100%;
      font-size: 1.5em;
      font-weight: bold;
    }
    .card {
      margin: 20px;
      padding: 20px;
      background: #222;
      border-radius: 12px;
      width: 90%;
      max-width: 420px;
      text-align: left;
      box-shadow: 0 0 12px rgba(0,0,0,0.6);
    }
    .row {
      display: flex;
      justify-content: space-between;
      margin: 8px 0;
      font-size: 1.1em;
    }
    .up { color: #0f0; font-weight: bold; }
    .down { color: #f33; font-weight: bold; }
    .strength { color: #0ff; font-weight: bold; }
  </style>
</head>
<body>
  <header>BTC Expected Move</header>

  <div class="card">
    <div class="row"><span>Price:</span> <span id="price">-</span></div>
    <div class="row"><span>Expected Move:</span> <span id="em">-</span></div>
    <div class="row up"><span>Up:</span> <span id="up">-</span></div>
    <div class="row down"><span>Down:</span> <span id="down">-</span></div>
    <div class="row"><span>Strength:</span> <span id="strength">-</span>%</div>
    <div class="row"><span>Time Left:</span> <span id="time">-</span></div>
  </div>

<script>
// جلب سعر BTC/USDT من Binance
async function getPrice(){
  let res = await fetch("https://api.binance.com/api/v3/ticker/price?symbol=BTCUSDT");
  let data = await res.json();
  return parseFloat(data.price);
}

// Black-Scholes Expected Move (مبسط)
function calculateEM(price, iv, secondsLeft){
  let T = secondsLeft / (60*60*24*365); // تحويل إلى سنوات
  return price * iv * Math.sqrt(T);
}

async function update(){
  let price = await getPrice();
  let iv = 0.6;            // مؤقتًا 60% IV (يمكن ربطه مع Options API لاحقًا)
  let secondsLeft = 20*60; // 20 دقيقة

  let em = calculateEM(price, iv, secondsLeft);
  let up = price + em;
  let down = price - em;

  // Strength: نسبة من 0 إلى 100
  let strength = 50; // هنا تقدر تعدل المعادلة لو حاب توازن مع gap to beat

  document.getElementById("price").innerText = price.toFixed(2);
  document.getElementById("em").innerText = em.toFixed(2);
  document.getElementById("up").innerText = up.toFixed(2);
  document.getElementById("down").innerText = down.toFixed(2);
  document.getElementById("strength").innerText = strength.toFixed(1);
  document.getElementById("time").innerText = (secondsLeft/60).toFixed(1)+" min";
}

// تحديث أولي وكل 5 ثواني
update();
setInterval(update, 5000);
</script>
</body>
</html>
